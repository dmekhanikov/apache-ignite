# name: test/sql/aggregate/aggregates/test_aggregate_types.test
# description: Test aggregates with many different types
# group: [aggregates]
# Ignore: https://issues.apache.org/jira/browse/IGNITE-14636

statement ok
CREATE TABLE strings(s VARCHAR, g INTEGER)

statement ok
INSERT INTO strings VALUES ('hello', 0), ('world', 1), (NULL, 0), ('r', 1)


# add string agg
query TTTT
SELECT STRING_AGG(s, ' '), STRING_AGG(s, ''), STRING_AGG('', ''), STRING_AGG('hello', ' ') FROM strings
----
hello world r
helloworldr
(empty)
hello hello hello hello

# more complex agg (groups)
query IIITTT
SELECT g, COUNT(*), COUNT(s), MIN(s), MAX(s), STRING_AGG(s, ' ') FROM strings GROUP BY g ORDER BY g
----
0
2
1
hello
hello
hello
1
2
2
r
world
world r

# empty group
query IIITTT
SELECT g, COUNT(*), COUNT(s), MIN(s), MAX(s), STRING_AGG(s, ' ') FROM strings WHERE s IS NULL OR s <> 'hello' GROUP BY g ORDER BY g
----
0
1
0
NULL
NULL
NULL
1
2
2
r
world
world r
