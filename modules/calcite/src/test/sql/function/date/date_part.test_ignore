# name: test/sql/function/date/date_part_stats.test
# description: Test date part stats on empty table
# group: [date]
# Ignored: https://issues.apache.org/jira/browse/IGNITE-14955

statement ok
CREATE TABLE dates(d DATE);

# test stats propagation from empty table
query I
SELECT YEARWEEK(d) FROM dates;
----

query I
SELECT DAYOFMONTH(d) FROM dates;
----

query I
SELECT WEEKDAY(d) FROM dates;
----

query I
SELECT WEEKOFYEAR(d) FROM dates;
----

statement ok
INSERT INTO dates VALUES (DATE '1992-01-01'), (DATE '2000-12-31');

query I
SELECT stats(YEARWEEK(d)) FROM dates LIMIT 1;
----
<REGEX>:.*199201.*200052.*

query I
SELECT stats(WEEKDAY(d)) FROM dates LIMIT 1;
----
<REGEX>:.*0.*6.*

query I
SELECT stats(WEEKOFYEAR(d)) FROM dates LIMIT 1;
----
<REGEX>:.*1.*54.*

